<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Explore STUR Physics ‚Äì Interactive Sandbox</title>

<style>
  body {
    background:#050814;
    color:#e6edf3;
    font-family:'Courier New', monospace;
    margin:0;
    padding:1.5rem;
  }
  h1 { text-align:center; color:#ffaa00; margin-bottom:0.75rem; }
  h2 { color:#ffcc33; }
  .panel {
    background:#0a0f1f;
    padding:1rem;
    border-radius:8px;
    max-width:900px;
    margin:1rem auto;
    box-shadow:0 0 12px #ffaa0044;
  }
  .text { max-width:900px; margin:0 auto; line-height:1.5; }
  label { display:block; margin-top:12px; }
  input[type=range] { width:100%; }
  canvas {
    width:100%;
    height:260px;
    background:#000;
    border-radius:6px;
    margin-top:1rem;
  }
  button {
    background:#ffaa00;
    color:#050814;
    border:none;
    border-radius:6px;
    padding:8px 14px;
    margin:4px;
    cursor:pointer;
    font-family:'Courier New', monospace;
    font-size:0.9rem;
  }
  button:hover { background:#ffcc33; }
  pre { white-space:pre-wrap; color:#00ffcc; font-size:0.9rem; }
  .links { text-align:center; margin-top:1.5rem; }
  .links a {
    display:inline-block;
    background:#0e1624;
    color:#5ad0ff;
    border:1px solid #5ad0ff;
    padding:8px 14px;
    border-radius:6px;
    text-decoration:none;
    margin:4px;
    font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
    font-size:0.9rem;
  }
</style>
</head>
<body>

<h1>Explore STUR Physics ‚Äì Interactive Sandbox</h1>

<!-- ===================================================== -->
<!-- EXPANDED INTRO -->
<!-- ===================================================== -->
<p class="text">
üîç <b>Welcome to the STUR Geometry Sandbox.</b> This page is a hands-on field 
explorer designed to help anyone‚Äîfrom middle-school students to researchers‚Äî
experiment with how geometry shapes force and motion. Every slider and button 
on this page works. The curve you build is the curve the particle experiences.
<br><br>
STUR models forces using a geometric field:
<code>S(r) = tanh(r / L‚ÇÄ) ¬∑ (1 ‚àí e<sup>‚àír / L‚ÇÄ</sup>)</code>.
Here, you can modify and explore this field by adjusting the geometry scale, 
curve sharpness, amplitude, blending with the derivative, and horizontal range.
<br><br>
After shaping the field, scroll to the sandbox at the bottom to launch a 
particle inside the curve you created and watch the resulting motion.
<br><br>
<b>Beginners:</b> Experiment freely. Watch how sliders reshape the curve.  
<b>Advanced users:</b> Explore curvature kernels, derivative-driven dynamics, 
and toy-model potentials inspired by STUR geometry.
</p>

<!-- ===================================================== -->
<!-- EDUCATIONAL CONTENT -->
<!-- ===================================================== -->

<div class="panel">
  <h2>How Iteration in Science Works</h2>
  <p class="text">
Scientific progress grows from iteration: trying ideas, testing them, finding 
what breaks, and adjusting. This cycle‚Äîtry ‚Üí observe ‚Üí refine‚Äîis how real 
discoveries are made. Exploration is not about perfection; it is about learning 
from attempts.
  </p>
</div>

<div class="panel">
  <h2>How to Use Python Runners Like Jupyter</h2>
  <p class="text">
A Python runner (Jupyter, JupyterLite, Colab) is a live notebook environment 
where code can be written and executed immediately. You paste code, press ‚ÄúRun,‚Äù 
and see plots, numbers, and behaviors appear. The data exported from this sandbox 
can be used directly in such tools for deeper analysis.
  </p>
</div>

<div class="panel">
  <h2>Using AI as a Scientific Tool</h2>
  <p class="text">
Multiple AI systems can act as additional reviewers: one can check clarity, 
another consistency, another logic. This accelerates refinement and reduces the 
barrier to testing ideas. AI does not replace thought but amplifies iteration.
  </p>
</div>

<div class="panel">
  <h2>Science, Scrutiny, and Openness</h2>
  <p class="text">
Scrutiny is essential to scientific progress. However, traditional scrutiny is 
often tied to institutional pathways that can limit access. This sandbox is part 
of a more open approach, enabling anyone to explore physical ideas directly by 
modifying geometry and observing the consequences.
  </p>
</div>

<div class="panel">
  <h2>How to Explore Using This Sandbox</h2>
  <p class="text">
‚Ä¢ Adjust <b>L‚ÇÄ</b> to stretch or compress the field horizontally.<br>
‚Ä¢ Adjust <b>A</b> to scale the field vertically.<br>
‚Ä¢ Change <b>n</b> to sharpen or soften the curve.<br>
‚Ä¢ Move <b>R<sub>max</sub></b> to zoom in or out.<br>
‚Ä¢ Use <b>d</b> to blend between the modified field and its derivative.<br><br>
After modifying the geometry, scroll down to the sandbox to watch a particle 
move according to the slope of the curve you created.
  </p>
</div>

<div class="panel">
  <h2>STUR Geometry Map</h2>
  <pre>
Energy + Information
        ‚Üì
   Resistance Geometry  S(r)
        ‚Üì
   Curvature / Slope  dS/dr
        ‚Üì
       Force  F(r)
        ‚Üì
      Motion
  </pre>
  <p class="text">
The sandbox below sits at the center of this chain, letting you explore geometry, 
its derivative, and the resulting motion.
  </p>
</div>

<!-- ===================================================== -->
<!-- CONTROLS SECTION (appears BEFORE the graph) -->
<!-- ===================================================== -->

<div class="panel">
  <h2>Field Controls</h2>

  <label>L‚ÇÄ (geometry scale): <span id="L0_val">1.0</span></label>
  <input type="range" id="L0" min="0.2" max="3" value="1" step="0.1">

  <label>A (amplitude scale): <span id="A_val">1.0</span></label>
  <input type="range" id="A" min="0.2" max="3" value="1" step="0.1">

  <label>n (tanh exponent): <span id="n_val">1.0</span></label>
  <input type="range" id="n" min="0.5" max="3" value="1" step="0.1">

  <label>R<sub>max</sub> (horizontal range): <span id="Rmax_val">5.0</span></label>
  <input type="range" id="Rmax" min="2" max="10" value="5" step="0.5">

  <label>d (blend S vs. S‚Ä≤, 0‚Üí1): <span id="d_val">0.00</span></label>
  <input type="range" id="blend" min="0" max="1" value="0" step="0.05">

  <div style="margin-top:0.75rem;">
    <button id="toggleAnim">‚ñ∂ Start Particle</button>
    <button id="resetBtn">‚ü≤ Reset</button>
    <button id="downloadBtn">‚¨á Download Data</button>
  </div>
</div>

<!-- ===================================================== -->
<!-- SANDBOX + OUTPUT (BOTTOM OF PAGE) -->
<!-- ===================================================== -->

<div class="panel">
  <h2>STUR Sandbox ‚Äì Curve & Particle Motion</h2>
  <canvas id="plot" width="800" height="260"></canvas>
  <pre id="output"></pre>
</div>

<!-- ===================================================== -->
<!-- LINKS -->
<!-- ===================================================== -->
<div class="links">
  <a href="../index.html">‚Üê STUR Physics Lab</a>
  <a href="https://x.com/that1sheldon" target="_blank">‚ú¶ X</a>
  <a href="https://www.tiktok.com/@that1sheldon" target="_blank">üéµ TikTok</a>
  <a href="https://github.com/sheldonlindberg-afk/STUR-Physics-Lab" target="_blank">‚öõ GitHub</a>
</div>

<!-- ===================================================== -->
<!-- JAVASCRIPT (FULLY FUNCTIONAL) -->
<!-- ===================================================== -->
<script>
// ---------- Base STUR functions ----------
function S_base(r, L0) {
  const x = r / L0;
  return Math.tanh(x) * (1 - Math.exp(-x));
}

function S_prime(r, L0) {
  const x = r / L0;
  const sech2 = 1 / Math.cosh(x)**2;
  return (sech2*(1 - Math.exp(-x)) + Math.tanh(x)*Math.exp(-x)) / L0;
}

function S_mod(r, L0, A, n) {
  const x = r / L0;
  const t = Math.tanh(x);
  return A * (t**n) * (1 - Math.exp(-x));
}

function S_blend(r, L0, A, n, d) {
  const Smod = S_mod(r, L0, A, n);
  const Sprime = S_prime(r, L0);
  return (1-d)*Smod + d*Sprime;
}

function dS_blend_dr(r, L0, A, n, d) {
  const h = 1e-3 * Math.max(1, L0);
  const r1 = Math.max(0, r - h);
  const r2 = r + h;
  const f1 = S_blend(r1, L0, A, n, d);
  const f2 = S_blend(r2, L0, A, n, d);
  return (f2 - f1) / (r2 - r1);
}

// ---------- DOM ----------
const L0_slider = document.getElementById("L0");
const A_slider = document.getElementById("A");
const n_slider = document.getElementById("n");
const Rmax_slider = document.getElementById("Rmax");
const blend_slider = document.getElementById("blend");

const L0_val = document.getElementById("L0_val");
const A_val = document.getElementById("A_val");
const n_val = document.getElementById("n_val");
const Rmax_val = document.getElementById("Rmax_val");
const d_val = document.getElementById("d_val");

const outputEl = document.getElementById("output");
const canvas = document.getElementById("plot");
const ctx = canvas.getContext("2d");

const toggleAnimBtn = document.getElementById("toggleAnim");
const resetBtn = document.getElementById("resetBtn");
const downloadBtn = document.getElementById("downloadBtn");

// ---------- Particle ----------
let particle = { r: 2.5, v: 0.0 };
let animating = false;

// ---------- Main update ----------
function update() {
  const L0 = parseFloat(L0_slider.value);
  const A = parseFloat(A_slider.value);
  const n = parseFloat(n_slider.value);
  const Rmax = parseFloat(Rmax_slider.value);
  const d = parseFloat(blend_slider.value);

  if (particle.r > Rmax) particle.r = Rmax;

  L0_val.textContent = L0.toFixed(2);
  A_val.textContent = A.toFixed(2);
  n_val.textContent = n.toFixed(2);
  Rmax_val.textContent = Rmax.toFixed(1);
  d_val.textContent = d.toFixed(2);

  drawScene(L0, A, n, Rmax, d);

  const rp = particle.r;
  const Sraw = S_base(rp, L0);
  const Smod = S_mod(rp, L0, A, n);
  const Sbl = S_blend(rp, L0, A, n, d);
  const Spr = S_prime(rp, L0);
  const slope = dS_blend_dr(rp, L0, A, n, d);
  const F = -slope;

  outputEl.textContent =
`Field Parameters:
  L‚ÇÄ   = ${L0.toFixed(2)}
  A    = ${A.toFixed(2)}
  n    = ${n.toFixed(2)}
  Rmax = ${Rmax.toFixed(2)}
  d    = ${d.toFixed(2)}

Sample at r = ${rp.toFixed(3)}:

  Base STUR:
    S_base   = ${Sraw.toFixed(6)}
    S'_base  = ${Spr.toFixed(6)}

  Modified:
    S_mod    = ${Smod.toFixed(6)}

  Blended:
    S_blend  = ${Sbl.toFixed(6)}
    dS/dr    = ${slope.toExponential(6)}

  1D Toy Force:
    F(r) ‚âà ‚àí dS/dr = ${F.toExponential(6)}

Interpretation:
  ‚Ä¢ The curve on the canvas is S_blend(r).
  ‚Ä¢ All sliders modify the geometry of that curve.
  ‚Ä¢ The particle moves according to the local slope of the field.`;
}

// ---------- Draw ----------
function drawScene(L0, A, n, Rmax, d) {
  const W = canvas.width;
  const H = canvas.height;
  ctx.clearRect(0,0,W,H);

  ctx.strokeStyle="#444";
  ctx.lineWidth=1;
  ctx.beginPath();
  ctx.moveTo(0,H/2);
  ctx.lineTo(W,H/2);
  ctx.stroke();

  ctx.strokeStyle="#ffaa00";
  ctx.lineWidth=2;
  ctx.beginPath();

  for (let i=0;i<=W;i++){
    const r=(i/W)*Rmax;
    let val=S_blend(r,L0,A,n,d);
    if(val>1.2)val=1.2;
    if(val<-1.2)val=-1.2;
    const y=H/2 - val*(H*0.4);
    if(i===0)ctx.moveTo(i,y);
    else ctx.lineTo(i,y);
  }
  ctx.stroke();

  let rp = particle.r;
  if(rp<0)rp=0;
  if(rp>Rmax)rp=Rmax;

  let valp=S_blend(rp,L0,A,n,d);
  if(valp>1.2)valp=1.2;
  if(valp<-1.2)valp=-1.2;

  const x=(rp/Rmax)*W;
  const y_p=H/2 - valp*(H*0.4);
  ctx.fillStyle="#00ffcc";
  ctx.beginPath();
  ctx.arc(x,y_p,6,0,2*Math.PI);
  ctx.fill();
}

// ---------- Animation ----------
function stepParticle(L0,A,n,Rmax,d,dt){
  const slope=dS_blend_dr(particle.r,L0,A,n,d);
  const a=-slope;
  particle.v+=a*dt;
  particle.r+=particle.v*dt;
  if(particle.r<0){particle.r=0;particle.v*=-0.4;}
  if(particle.r>Rmax){particle.r=Rmax;particle.v*=-0.4;}
}

function animate(ts){
  if(!animating)return;
  const L0=parseFloat(L0_slider.value);
  const A=parseFloat(A_slider.value);
  const n=parseFloat(n_slider.value);
  const Rmax=parseFloat(Rmax_slider.value);
  const d=parseFloat(blend_slider.value);
  const dt=0.03;
  for(let i=0;i<4;i++){
    stepParticle(L0,A,n,Rmax,d,dt);
  }
  update();
  requestAnimationFrame(animate);
}

// ---------- Event Listeners ----------
[L0_slider,A_slider,n_slider,Rmax_slider,blend_slider].forEach(sl=>{
  sl.addEventListener("input",update);
});

toggleAnimBtn.addEventListener("click",()=>{
  animating=!animating;
  toggleAnimBtn.textContent=animating?"‚è∏ Pause Particle":"‚ñ∂ Start Particle";
  if(animating)requestAnimationFrame(animate);
});

resetBtn.addEventListener("click",()=>{
  L0_slider.value=1;
  A_slider.value=1;
  n_slider.value=1;
  Rmax_slider.value=5;
  blend_slider.value=0;
  particle.r=2.5;
  particle.v=0;
  animating=false;
  toggleAnimBtn.textContent="‚ñ∂ Start Particle";
  update();
});

downloadBtn.addEventListener("click",()=>{
  const L0=parseFloat(L0_slider.value);
  const A=parseFloat(A_slider.value);
  const n=parseFloat(n_slider.value);
  const Rmax=parseFloat(Rmax_slider.value);
  const d=parseFloat(blend_slider.value);

  const points=[];
  const N=200;
  for(let i=0;i<=N;i++){
    const r=(i/N)*Rmax;
    points.push({
      r,
      S_base:S_base(r,L0),
      S_mod:S_mod(r,L0,A,n),
      S_prime:S_prime(r,L0),
      S_blend:S_blend(r,L0,A,n,d)
    });
  }

  const blob=new Blob([JSON.stringify({
    L0,A,n,Rmax,d,points
  },null,2)],{type:"application/json"});

  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;
  a.download="stur_sandbox_curve.json";
  a.click();
  URL.revokeObjectURL(url);
});

// ---------- Initial render ----------
update();
</script>

</body>
</html>
