<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STUR QC – Resistance Flow & Continuity Verifier</title>
<style>
body{
  background:#050814;
  color:#e6edf3;
  font-family:"Courier New",monospace;
  margin:0;
  padding:2rem;
}
h1{color:#ffaa00;text-align:center;}
h2{color:#ffcc33;margin-top:2rem;}
.desc{
  max-width:960px;
  margin:0 auto 1.5rem auto;
  line-height:1.6;
}
pre{
  background:#0a0f1f;
  color:#00ffcc;
  padding:1rem;
  border-radius:8px;
  overflow-x:auto;
  font-size:0.86rem;
  box-shadow:0 0 18px #ffaa0040;
}
button{
  background:#ffaa00;
  color:#050814;
  border:none;
  border-radius:6px;
  padding:10px 20px;
  font-weight:bold;
  cursor:pointer;
  margin:6px;
  transition:0.2s;
}
button:hover{background:#ffcc33;}
footer{
  text-align:center;
  font-size:0.9em;
  color:#999;
  margin-top:2rem;
}
a{color:#66ccff;}
.center{text-align:center;margin-top:1rem;}
</style>
</head>
<body>

<h1>STUR QC – Resistance Flow &amp; Continuity Verifier</h1>

<div class="desc">
<p>
This <b>STUR QC lattice verifier</b> was inspired by Lucas Nash X@lukenash and tests deterministic entanglement and flux invariance under the <b>Resistance Field Model</b>.
It evaluates whether local densities and bond currents obey a true continuity equation without invoking the Born rule:
</p>

<p style="text-align:center;">
dρ<sub>i</sub>/dt + Σ<sub>j</sub>J<sub>i→j</sub> ≈ 0
</p>

<p>
This means the resistance field Ψ behaves like a conserved fluid of informational energy.
The test evolves a 6-site STUR lattice, computes entanglement entropy S<sub>A</sub>(t),
and tracks global flux Φ<sub>R</sub>(t) for numerical invariance.
</p>

<p>
Results output:
</p>
<ul>
<li><code>stur_qc_densities.png</code> – ρ<sub>i</sub>(t) field heatmap</li>
<li><code>stur_qc_current.png</code> – bond current trace</li>
<li><code>stur_qc_globals.png</code> – S<sub>A</sub> and Φ<sub>R</sub> invariants</li>
<li><code>stur_qc_summary.json</code> – numerical metadata</li>
</ul>
</div>

<h2>Python Simulation (copy &amp; run)</h2>

<pre id="codeBlock"># STUR QC – Resistance Flow & Continuity Verifier
# Verified Python 3.13, NumPy/SciPy compatible
# Generates JSON + 3 figures (dark theme)
# --------------------------------------------------

import numpy as np, math, json
from numpy.linalg import eig
from scipy.linalg import expm
import matplotlib.pyplot as plt
plt.style.use("dark_background")

def S_STUR(r,L0):x=r/L0;return math.tanh(x)*(1-math.exp(-x))
I2=np.eye(2,complex);sx=np.array([[0,1],[1,0]],complex)
sy=np.array([[0,-1j],[1j,0]],complex);sz=np.array([[1,0],[0,-1]],complex)
s_plus=np.array([[0,1],[0,0]],complex);s_minus=np.array([[0,0],[1,0]],complex)
def kron_all(ops):o=ops[0];[o:=np.kron(o,p)for p in ops[1:]];return o
def single_op(p,s,N):ops=[I2]*N;ops[s]=p;return kron_all(ops)
def two_op(a,i,b,j,N):ops=[I2]*N;ops[i]=a;ops[j]=b;return kron_all(ops)

def build_R_STUR(N,L0=1,a=1,h0=1,J0=1,Om=0.5):
 R=np.zeros((2**N,2**N),complex);pos=np.arange(N)*a
 for i in range(N):R+=h0*S_STUR(pos[i],L0)*single_op(sz,i,N)
 for i in range(N):
  for j in range(i+1,N):
   r=abs(pos[i]-pos[j]);S=S_STUR(r,L0)
   R+=J0*S*(two_op(sx,i,sx,j,N)+two_op(sy,i,sy,j,N))
 for i in range(N):R+=Om*S_STUR(pos[i],L0)*single_op(sx,i,N)
 return R,pos

def evolve(R,psi0,t,T,hbar=1):
 dt=t/T;U=expm(-1j*R*dt/hbar);p=psi0.copy();traj=[p.copy()]
 for _ in range(T):p=U@p;p/=np.linalg.norm(p);traj.append(p.copy())
 return np.array(traj),dt

def S_ent(psi,N,NA):
 NB=N-NA;psiM=psi.reshape(2**NA,2**NB);rho=psiM@psiM.conj().T
 v,_=eig(rho);v=np.clip(np.real_if_close(v),0,1);v=v[v>1e-12]
 return -float(np.sum(v*np.log2(v))) if v.size else 0

def Phi_R(psi,R):return float(np.real(np.vdot(psi,R@psi)))

def dens_ops(N):return[0.5*(single_op(I2,i,N)-single_op(sz,i,N))for i in range(N)]
def local_dens(traj,ops):return np.array([[np.real(np.vdot(p,o@p))for o in ops]for p in traj])

def Jbonds(traj,N,pos,L0,J0):
 sp={i:single_op(s_plus,i,N)for i in range(N)}
 sm={i:single_op(s_minus,i,N)for i in range(N)}
 cur=[]
 for p in traj:
  M=np.zeros((N,N))
  for i in range(N):
   for j in range(N):
    if i==j:continue
    r=abs(pos[i]-pos[j]);J=J0*S_STUR(r,L0)
    op=sp[i]@sm[j];M[i,j]=4*J*np.imag(np.vdot(p,op@p))
  cur.append(M)
 return np.array(cur)

def continuity_res(d,c,dt):
 T,N=d.shape;m=0
 for t in range(1,T-1):
  dρ=(d[t+1]-d[t-1])/(2*dt)
  for i in range(N):m=max(m,abs(dρ[i]+np.sum(c[t][i,:])))
 return m

def plots_json(d,c,dt,Sv=None,Fv=None):
 T,N=d.shape;t=np.linspace(0,dt*(T-1),T)
 i,j=0,1;Jt=c[:,i,j]
 fig,ax=plt.subplots();im=ax.imshow(d.T,aspect='auto',origin='lower',
 extent=[t[0],t[-1],0,N-1]);ax.set_xlabel('time');ax.set_ylabel('site')
 ax.set_title('STUR local density ρᵢ(t)');fig.colorbar(im,ax=ax)
 fig.savefig('stur_qc_densities.png',dpi=200)
 fig,ax=plt.subplots();ax.plot(t,Jt,label=f'J_{i}->{j}(t)')
 ax.set_xlabel('time');ax.set_ylabel('bond current')
 ax.set_title('STUR bond current');ax.legend();fig.savefig('stur_qc_current.png',dpi=200)
 if Sv or Fv:
  fig,ax=plt.subplots()
  if Sv:ax.plot(t[:len(Sv)],Sv,label='S_A(bits)')
  if Fv:ax.plot(t[:len(Fv)],Fv,'--',label='Φ_R')
  ax.set_xlabel('time');ax.set_title('STUR global invariants')
  ax.legend();fig.savefig('stur_qc_globals.png',dpi=200)
 summary={'N':N,'dt':float(dt),'J_index':[i,j],
          'ρmin':float(d.min()),'ρmax':float(d.max()),
          'Jmin':float(Jt.min()),'Jmax':float(Jt.max())}
 with open('stur_qc_summary.json','w')as f:json.dump(summary,f,indent=2)

if __name__=='__main__':
 N,NA,L0,a,h0,J0,Om,tF,ns=6,3,1,1,1,0.8,0.6,5,200
 R,pos=build_R_STUR(N,L0,a,h0,J0,Om)
 psi=np.zeros(2**N,complex);psi[0]=1
 traj,dt=evolve(R,psi,tF,ns)
 S=[S_ent(p,N,NA)for p in traj];F=[Phi_R(p,R)for p in traj]
 print(f'Max S_A={max(S):.3f} bits; Φ_R drift={max(F)-min(F):.3e}')
 Rx,_=build_R_STUR(N,L0,a,0,J0,0)
 psi2=np.zeros(2**N,complex);psi2[1]=1
 traj2,dt2=evolve(Rx,psi2,1,400)
 d=local_dens(traj2,dens_ops(N));c=Jbonds(traj2,N,pos,L0,J0)
 print(f'Max|dρ/dt+ΣJ|={continuity_res(d,c,dt2):.3e}')
 plots_json(d,c,dt2,Sv=S,Fv=F)
 print('Saved STUR QC plots + stur_qc_summary.json')</pre>

<div class="center">
  <button onclick="copyCode()">Copy Python Script</button>
  <button onclick="openJupyter()">Open JupyterLite</button>
  <button onclick="goBack()">⬅ Back to STUR Lab</button>
</div>

<footer>
&copy; 2025 Sheldon Lon Lindberg • STUR Physics Framework • CC-BY-4.0 License
</footer>

<script>
function copyCode(){
  const code=document.getElementById("codeBlock").innerText;
  navigator.clipboard.writeText(code);
  alert("STUR QC script copied to clipboard.");
}
function openJupyter(){
  window.open("https://jupyter.org/try-jupyter/lab/","_blank");
}
function goBack(){
  window.location.href="../index.html";
}
</script>
</body>
</html>
