<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STUR Weather 2D — JSON Field Simulation</title>
<style>
body{
  background:#020408;
  color:#e8ecf2;
  font-family:"Courier New",monospace;
  margin:0;
  padding:2rem;
}
h1{color:#ffcc00;text-align:center;}
h2{color:#ffcc00;}
pre{
  background:#0a0f1a;
  color:#00ffaa;
  padding:1rem;
  border-radius:8px;
  overflow-x:auto;
  font-size:0.9rem;
  box-shadow:0 0 12px #ffcc0060;
  white-space:pre;
}
button{
  background:#ffcc00;
  color:#000;
  border:none;
  border-radius:6px;
  padding:10px 20px;
  font-weight:bold;
  cursor:pointer;
  margin:6px;
}
button:hover{background:#ffee55;}
footer{text-align:center;font-size:0.9em;color:#999;margin-top:2rem;}
</style>
</head>
<body>

<h1>STUR Weather – 2D Hybrid Atmospheric Simulation</h1>

<h2>Derivation Summary</h2>
<pre>
S(r,L₀) = tanh(r/L₀) (1 − e^(−r/L₀))
F_STUR(r) = S(r,L₀) [kₑ q₁q₂ / r² − G m₁m₂ / r² + αₛ((1 − e^(−r/λ))/r² + σr)] + γ₀ e^(−r/ℓ_B)(S×B)
ρ_air, g, ν define the background fluid coupling.
Grid evolves via v(t+Δt)=v+FΔt, r(t+Δt)=r+vΔt.
</pre>

<h2>Python Simulation (copy to Jupyter)</h2>

<pre id="codeBlock">#!/usr/bin/env python3
# ===============================================================
# STUR Weather 2D – JSON Output Only
# ===============================================================
import numpy as np, json, math

# --- Constants ---
k_e,G,sigma_s=8.9875e9,6.6743e-11,1e-5
lam,lB=1e-15,1e2
q1,q2,m1,m2=1e-6,1e-6,1e3,1e3
rho_air,g,nu=1.2,9.81,1e-2
L0,alpha_s,gamma0=1e5,1e-9,1e-3
dt,n_steps=0.5,60
np.random.seed(0)

# --- STUR Modulator ---
def S_r(r,L0): return math.tanh(r/L0)*(1.0-math.exp(-r/L0))
def F_sheldon(r,v):
    r_norm=float(np.linalg.norm(r))
    if r_norm==0: return np.zeros(2)
    r_hat=r/r_norm
    coul=k_e*q1*q2/(r_norm**2)
    grav=-G*m1*m2/(r_norm**2)
    strong=alpha_s*((1.0-math.exp(-r_norm/lam))/(r_norm**2)+sigma_s*r_norm)
    F_rad=S_r(r_norm,L0)*(coul+grav+strong)*r_hat
    return F_rad

# --- Grid ---
nx,ny=25,25
xv=np.linspace(-1e3,1e3,nx)
yv=np.linspace(-1e3,1e3,ny)
X,Y=np.meshgrid(xv,yv)
pos=np.stack([X.flatten(),Y.flatten()],axis=-1)
vel=np.zeros_like(pos)
T=np.ones(pos.shape[0])*290.0
P=np.ones(pos.shape[0])*101325.0

# --- Time evolution ---
for _ in range(n_steps):
    vel[:,0]+=0.0001*(pos[:,1]/1e3)
    for i in range(pos.shape[0]):
        F_fluid=np.array([0.0,(P[i]-101325.0)/50.0])*(-1/rho_air)+nu*np.random.randn(2)*0.01
        F_total=F_fluid+F_sheldon(pos[i],vel[i])
        vel[i]+=F_total*dt
        pos[i]+=vel[i]*dt
        vy=vel[i,1]
        T[i]+=(-g/1000.0)*vy*dt
        P[i]-=0.05*vy*dt

# --- Event masks ---
microburst=vel[:,1]<-10
Lz=pos[:,0]*vel[:,1]-pos[:,1]*vel[:,0]
funnels=np.abs(Lz)>0.05
heat=T>300.0

# --- Summary JSON ---
out={
 "model":"STUR Weather 2D",
 "grid":{"nx":nx,"ny":ny,"points":int(pos.shape[0])},
 "time":{"dt_s":dt,"steps":n_steps,"total_s":dt*n_steps},
 "events":{
   "microbursts":int(np.sum(microburst)),
   "funnels":int(np.sum(funnels)),
   "heat_domes":int(np.sum(heat))
 },
 "fields":{
   "T_min_K":float(np.min(T)),
   "T_max_K":float(np.max(T)),
   "P_min_Pa":float(np.min(P)),
   "P_max_Pa":float(np.max(P)),
   "vx_mean":float(np.mean(vel[:,0])),
   "vy_mean":float(np.mean(vel[:,1])),
   "speed_rms":float(np.sqrt(np.mean(np.sum(vel**2,axis=1))))
 }
}
print(json.dumps(out,indent=2))
</pre>

<div style="text-align:center;">
  <button onclick="copyCode()">Copy Script</button>
  <button onclick="openJupyter()">Open in JupyterLite</button>
</div>

<footer>© 2025 STUR Physics Lab – Unified Resistance Atmospheric Model</footer>

<script>
function copyCode(){
  navigator.clipboard.writeText(document.getElementById("codeBlock").innerText);
  alert("STUR Weather 2D JSON simulation copied to clipboard.");
}
function openJupyter(){
  window.open("https://jupyter.org/try-jupyter/lab/","_blank");
}
</script>

</body>
</html>
