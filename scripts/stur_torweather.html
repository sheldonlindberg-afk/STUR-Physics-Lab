<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STUR Weather – Hybrid Atmospheric Field Simulation (2D)</title>
<style>
  body {
    background:#050814; color:#e6edf3; font-family:"Courier New",monospace;
    margin:0; padding:2rem;
  }
  h1{ color:#ffaa00; text-align:center; }
  h2{ color:#ffcc33; margin-top:2rem; }
  pre{
    background:#0a0f1f; color:#00ffcc;
    padding:1rem; border-radius:8px;
    overflow-x:auto; font-size:0.9rem;
    box-shadow:0 0 18px #ffaa0040;
  }
  button{
    background:#ffaa00; color:#050814;
    border:none; border-radius:6px;
    padding:10px 20px; font-weight:bold;
    cursor:pointer; margin:6px;
  }
  button:hover{ background:#ffcc33; }
  footer{
    margin-top:2rem; text-align:center;
    font-size:0.9em; color:#999;
  }
  a{color:#66ccff;}
</style>
</head>
<body>

<h1>STUR Weather – Simplified 2D Field Simulation</h1>

<h2>Derivation Summary</h2>
<p>
This simplified 2D STUR weather model projects the unified resistance force field
onto the horizontal plane. Each grid parcel follows
</p>
<p style="text-align:center;">
F<sub>STUR</sub>(r) = S(r,L₀)[k<sub>e</sub>q₁q₂/r² − Gm₁m₂/r² + α<sub>s</sub>((1−e<sup>−r/λ</sup>)/r² + σr)]r̂
</p>
<p>
with modulator <code>S(r,L₀)=tanh(r/L₀)(1−e^{−r/L₀})</code>.
We update parcel velocity and position for <code>n_steps</code>, then visualize:
</p>
<ul>
  <li>Velocity field vectors</li>
  <li>Temperature map (K)</li>
  <li>Pressure map (Pa)</li>
</ul>

<h2>Python Simulation (copy &amp; run in Jupyter)</h2>

<pre id="codeBlock">#!/usr/bin/env python3
# ===============================================================
# STUR Weather – 2D Simplified Field Simulation
# ===============================================================
import numpy as np, matplotlib.pyplot as plt, json

# ---------------- Constants ----------------
k_e,G=8.9875e9,6.6743e-11
sigma_strong,lam=1e-5,1e-15
q1=q2=1e-6; m1=m2=1e3
rho_air=1.2; g=9.81; nu=1e-2
L0=1e5; alpha_s=1e-9; dt=0.5; n_steps=80
np.random.seed(0)

# ---------------- STUR modulator ----------------
def S_r(r,L0): return np.tanh(r/L0)*(1-np.exp(-r/L0))

def F_sheldon(r_vec):
    r=np.linalg.norm(r_vec); 
    if r==0: return np.zeros(2)
    r_hat=r_vec/r
    F_rad=S_r(r,L0)*((k_e*q1*q2/r**2 - G*m1*m2/r**2 + 
                      alpha_s*((1-np.exp(-r/lam))/r**2 + sigma_strong*r)))
    return F_rad*r_hat

# ---------------- Grid init ----------------
nx,ny=20,20
x=np.linspace(-1e3,1e3,nx)
y=np.linspace(-1e3,1e3,ny)
X,Y=np.meshgrid(x,y)
pos=np.stack([X.flatten(),Y.flatten()],axis=-1)
vel=np.zeros_like(pos)
T=np.ones(pos.shape[0])*290
P=np.ones(pos.shape[0])*101325

# ---------------- Time evolution ----------------
for step in range(n_steps):
    for i in range(len(pos)):
        F_fluid=-1/rho_air*np.array([0, (P[i]-101325)/50])+nu*np.random.randn(2)*0.01
        F_total=F_fluid+F_sheldon(pos[i])
        vel[i]+=F_total*dt
        pos[i]+=vel[i]*dt
        T[i]+=-g/1000*vel[i,1]*dt
        P[i]-=0.05*vel[i,1]*dt

# ---------------- Derived fields ----------------
speed=np.linalg.norm(vel,axis=1).reshape(nx,ny)
T_field=T.reshape(nx,ny)
P_field=P.reshape(nx,ny)

# ---------------- Plots ----------------
fig,axs=plt.subplots(1,3,figsize=(14,4))
axs[0].quiver(X,Y,vel[:,0].reshape(nx,ny),vel[:,1].reshape(nx,ny),scale=200)
axs[0].set_title("Velocity Field")
axs[1].imshow(T_field,extent=[x.min(),x.max(),y.min(),y.max()],origin="lower")
axs[1].set_title("Temperature (K)")
axs[2].imshow(P_field,extent=[x.min(),x.max(),y.min(),y.max()],origin="lower")
axs[2].set_title("Pressure (Pa)")
for a in axs: a.set_xlabel("x (m)"); a.set_ylabel("y (m)")
plt.tight_layout(); plt.show()

# ---------------- JSON summary ----------------
summary={
 "model":"STUR Weather 2D",
 "grid":{"nx":nx,"ny":ny,"points":nx*ny},
 "time":{"dt":dt,"steps":n_steps,"total_time":dt*n_steps},
 "fields":{
  "T_min":float(T.min()),"T_max":float(T.max()),
  "P_min":float(P.min()),"P_max":float(P.max()),
  "v_min":float(speed.min()),"v_max":float(speed.max())
 }}
print(json.dumps(summary,indent=2))
</pre>

<div style="text-align:center;">
  <button onclick="copyCode()">Copy Script</button>
  <button onclick="openRunner()">Open Jupyter Lite</button>
</div>

<footer>
© 2025 STUR Physics Lab | Unified Resistance Framework | Weather 2D Sim
</footer>

<script>
function copyCode(){
  const code=document.getElementById("codeBlock").innerText;
  navigator.clipboard.writeText(code);
  alert("STUR Weather 2D simulation code copied to clipboard.");
}
function openRunner(){
  window.open("https://jupyter.org/try-jupyter/lab/","_blank");
}
</script>

</body>
</html>
