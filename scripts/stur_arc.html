<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STUR Resistance Arc Simulator</title>
<style>
  body {
    background-color:#050814; color:#e6edf3;
    font-family: 'Courier New', monospace; margin:0; padding:2rem;
  }
  h1 { color:#ffaa00; text-align:center; }
  .desc { text-align:center; margin-bottom:1.5rem; }
  pre {
    background:#0a0f1f; padding:1rem; border-radius:8px;
    overflow-x:auto; color:#00ffcc; line-height:1.4;
    box-shadow:0 0 20px #ffaa0055;
  }
  button {
    background:#ffaa00; color:#050814; border:none; border-radius:6px;
    padding:10px 20px; font-weight:bold; cursor:pointer; margin:6px;
    transition:0.2s;
  }
  button:hover { background:#ffcc33; }
  footer {
    margin-top:2rem; text-align:center; font-size:0.9em; color:#aaa;
  }
</style>
</head>
<body>

<h1>âš¡ STUR Resistance Arc Simulator</h1>
<p class="desc">
Models plasmaâ€“magnetic coupling under the Unified Resistance Framework.<br>
Explore equilibrium, confinement, and feedback stability over 5 seconds of oscillation.
</p>

<h2>Python Code</h2>
<pre id="codeBlock">
#!/usr/bin/env python3
"""
STUR Resistance Arc Simulator â€“ 5-Second Runtime (Optimized)
------------------------------------------------------------
Simulates ~10,000 oscillations (0.5 ms period) with
down-sampled plotting for speed and clarity.

Outputs:
- Layperson-readable summary of the "spring" behavior
- Two graphs (force vs radius, displacement vs time)
- JSON block with all key parameters
"""

import numpy as np
import matplotlib.pyplot as plt
import json

# === Constants ===
mu0 = 4*np.pi*1e-7
mB  = 1e-6
q   = 1.6e-19
ke  = 8.9875e9
G   = 6.6743e-11
as0 = 1e-24
sig = 1e3
lam = 1e-15
L0  = 1e-10

B0, b1, b2 = 5, 500, 5e4
Abl = 3.1e-4
Vb  = 4.19e-6

U0 = 3e5
Ls = 1e-2

kB = 1.380649e-23
T0 = 300.0

c0  = 6e-3
eps = 1e-15
d0  = 1e-14
kfb = 1e9

kmin, kmax = 1e3, 1e4

# === Core STUR field + feedback ===
def S(r):
    """STUR radial modulator."""
    x = r/L0
    return np.tanh(x)*(1.0 - np.exp(-x))

def Fstur(r):
    """Net STUR resistance force vs radius."""
    return S(r)*(
        ke*q*q/r**2
        - G*mB*mB/r**2
        - as0*(1.0 - np.exp(-r/lam))/r**2
        + sig*r
    )

def dPB():
    return (B0*b1)/mu0

def d2PB():
    return (b1**2 + 2*b2*B0)/mu0

Fin0 = -Abl*dPB()
Kin  = -Abl*d2PB()

def Fout(r):
    """External confinement force."""
    return -Vb*U0*np.exp(-r/Ls)*(2.0/r**3 + 1.0/(Ls*r**2))

def Kout(r):
    """Effective curvature of external potential."""
    x = 1.0/Ls
    return -Vb*U0*np.exp(-r/Ls)*(-6.0/r**4 - 4.0*x/r**3 - x**2/r**2)

# Static stiffness from internal + external contributions
r0 = 1e-2
Keff_stat = -(Kin + Kout(r0))
kstat     = np.clip(Keff_stat, kmin, kmax)

def keff(d):
    """Dynamic stiffness with feedback as gap d shrinks."""
    return np.clip(kstat + kfb/(d + eps), kmin, kmax)

def damp(d):
    """Simple distance-dependent damping (effective friction)."""
    return c0*(d/d0)**0.5

# === Time evolution (5 s) ===
dt = 1e-7        # 0.1 microsecond step
tf = 5.0         # 5 seconds total
N  = int(tf/dt)  # raw steps (50 million)

# We only store a down-sampled trajectory for plotting:
Nsample = 500_000
skip    = max(1, N // Nsample)
Nt      = Nsample

x = np.zeros(Nt)
v = np.zeros(Nt)
d = np.zeros(Nt)

xi = 0.0
vi = 0.0
di = d0
d[0] = d0

for i in range(N):
    k = keff(di)
    c = damp(di)
    a = (-k*xi - c*vi)/mB

    vi += a*dt
    xi += vi*dt
    di -= (di - eps)*1e7*dt

    if i % skip == 0:
        j = i // skip
        if j < Nt:
            x[j] = xi
            v[j] = vi
            d[j] = di

# === Derived quantities ===
xrms = np.sqrt(np.mean(x**2))
dfin = d[-1]
ftrap = np.sqrt(keff(dfin)/mB)/(2.0*np.pi)

rg = np.linspace(1e-12, 1e-9, 400)
Ebind = np.trapz(Fstur(rg), rg)
Ebind_eV = Ebind/1.602e-19

coh = np.exp(-(kB*T0)/Ebind)

Ppk, tp = 5e5, 5e-3
Ep  = Ppk*tp
eta = 0.3
dump = eta*Ep
Ah   = 2e-2
mA   = 8.0
cp   = 500.0

dT   = (dump/Ah)/(mA*cp)
tau, fR = 0.1, 10.0
Tmean = T0 + dT*fR*tau/0.1

results = {
    "Fin0_N":            Fin0,
    "Kin_N_per_m":       Kin,
    "k_static_N_per_m":  kstat,
    "k_eff_end_N_per_m": keff(dfin),
    "f_trap_Hz":         ftrap,
    "x_rms_m":           xrms,
    "ring_final_m":      dfin,
    "E_bind_eV":         Ebind_eV,
    "coherence_ratio":   coh,
    "dT_K":              dT,
    "T_mean_K":          Tmean
}

# === Human-friendly summary ===
print("\n=== STUR Resistance Arc Summary (5 s) ===")
print(f"Initial internal force (Fin0):      {Fin0:8.2e} N")
print(f"Static spring stiffness (k_static): {kstat:8.2e} N/m")
print(f"Trap frequency:                     {ftrap:8.2e} Hz")
print(f"Approx. period:                     {1e3/ftrap:8.3f} ms")
print(f"RMS displacement:                   {xrms*1e9:8.3f} nm")
print(f"Final ring size (gap):              {dfin:8.2e} m")
print(f"Binding energy:                     {Ebind_eV:8.2e} eV")
print(f"Temperature rise:                   {dT:6.3f} K")
print(f\"Coherence ratio (stability score):  {coh:.3f}\")

print("""
Plain-language explanation:
This simulation treats the STUR arc like a microscopic spring made from
fields and resistance rather than metal. For 5 seconds, the ring â€œringsâ€
back and forth. If the coherence ratio is high, the oscillations stay
organized instead of dying quickly into random heat.
""")

# === Graphs ===
time = np.linspace(0.0, tf, Nt)

plt.figure(figsize=(10, 4))

# Force vs radius
plt.subplot(1, 2, 1)
plt.plot(rg*1e9, Fstur(rg))
plt.xlabel("Radius (nm)")
plt.ylabel("Force (N)")
plt.title("STUR Resistance Force vs Radius")

# Displacement vs time
plt.subplot(1, 2, 2)
plt.plot(time, x*1e9)
plt.xlabel("Time (s)")
plt.ylabel("Displacement (nm)")
plt.title("Arc Core Oscillation over 5 s")

plt.tight_layout()
plt.show()

# === JSON export ===
print("JSON output:")
print(json.dumps(results, indent=2))
</pre>

<div style="text-align:center;">
  <button onclick="copyCode()">ðŸ“‹ Copy Script</button>
  <button onclick="openRunner()">â–¶ Run Script</button>
</div>

<p style="text-align:center;margin-top:1rem;">
When you click <b>Run Script</b>, a Python&nbsp;3 environment will open.<br>
Paste the copied code and press <b>Run</b> to see live results and graphs (NumPy + Matplotlib supported).
</p>

<footer>
  Â© 2025 STUR Physics Lab | Open-Access Unified Resistance Framework | DOI pending
</footer>

<script>
function copyCode(){
  const code = document.getElementById("codeBlock").innerText;
  navigator.clipboard.writeText(code);
  alert("âœ… Script copied to clipboard!");
}
function openRunner(){
  window.open("https://colab.research.google.com","_blank");
}
</script>

</body>
</html>
