<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‚öõÔ∏è STUR Plasma Torus ‚Äî Multi-Particle 4D Manifold (Weak-Field GR)</title>
<style>
  :root {
    --bg:#050814; --fg:#e6edf3; --muted:#9fb0c3;
    --accent:#ffaa00; --link:#89b4ff;
    --card:#0b1020; --code:#0f1630; --border:#1b2442;
  }
  html,body {
    margin:0; padding:0;
    background:var(--bg); color:var(--fg);
    font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;
    line-height:1.45;
  }
  main {max-width:1100px;margin:0 auto;padding:28px;}
  h1{color:var(--accent);font-size:1.9rem;margin:.2rem 0 1rem}
  h2{color:#ffcc33;margin:1.6rem 0 .6rem;font-size:1.25rem}
  p,li{color:var(--fg)}
  .note{color:var(--muted)}
  .card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:16px}
  .eq{background:var(--card);border:1px dashed var(--border);padding:12px;border-radius:10px}
  pre{background:var(--code);border:1px solid var(--border);border-radius:10px;
      padding:14px;overflow:auto}
  code{font-family:inherit}
  .toolbar{display:flex;gap:10px;flex-wrap:wrap;margin:.75rem 0}
  .btn{cursor:pointer;border:1px solid var(--border);background:#0e1835;color:var(--fg);
       padding:8px 12px;border-radius:9px}
  .btn:hover{background:#122049}
  a{color:var(--link);text-decoration:none}
  .back{display:inline-block;margin-top:1.25rem}
  footer{margin:2rem 0 0;color:var(--muted);font-size:.9rem}
</style>
</head>
<body>
<main>
<h1>‚öõÔ∏è STUR Plasma Torus ‚Äî Multi-Particle 4D Manifold (Weak-Field GR)</h1>
<div class="note">Covariant Lorentz + STUR scalar per particle in a weak-field metric. JupyterLite-safe (NumPy + Matplotlib + JSON).</div>

<h2>Unified STUR-GR Derivation</h2>
<div class="eq">
<p><strong>Metric (weak-field GR):</strong>  
\( g_{00}=-(1+2\Phi/c^2),\; g_{ij}=(1-2\Phi/c^2)\delta_{ij},\; \Phi=-GM/r. \)  
Christoffels (first order): \( \Gamma^0{}_{0i}=\partial_i\Phi/c^2,\; \Gamma^i{}_{00}=\partial^i\Phi/c^2. \)</p>

<p><strong>Equation of motion (each particle a):</strong>  
\[
\frac{du^\mu_a}{d\tau}+\Gamma^\mu_{\alpha\beta}u^\alpha_a u^\beta_a
= \frac{q}{m}\,S_a\,F^\mu{}_{\nu}u^\nu_a,
\]
with \( \mathbf{E}=0,\ \mathbf{B}=B\hat{z} \Rightarrow F^{12}=-B,\ F^{21}=+B.\)</p>

<p><strong>STUR scalar per particle:</strong>  
\( S_a=\tanh(r_{\rm phys,a}/L_0)\big(1-e^{-r_{\rm phys,a}/L_0}\big), \)  
\( r_{\rm phys}^2 \!\approx\! (1-2\Phi/c^2)(x_a^2+y_a^2+z_a^2). \)</p>

<p><strong>Integrator (split Boris):</strong>  
Half-gravity ‚Üí STUR-scaled \( \mathbf v\times\mathbf B \) rotation ‚Üí half-gravity ‚Üí drift.  
Conserves \(u^\mu u_\mu\!\approx\!-c^2\) and captures confinement topology.</p>
</div>

<h2>Python Simulation</h2>
<div class="toolbar">
  <button class="btn" id="copyBtn">üìã Copy Script</button>
  <a class="btn" href="https://jupyterlite.github.io/demo/lab/index.html" target="_blank" rel="noopener">‚ñ∂Ô∏è Open in JupyterLite</a>
</div>

<pre><code id="pycode">#!/usr/bin/env python3
# ===============================================================
# STUR Plasma Torus ‚Äî Multi-Particle 4D Manifold (Weak-Field GR)
# JupyterLite-safe: NumPy + Matplotlib + JSON only
# ===============================================================

import numpy as np, math, json
import matplotlib.pyplot as plt
plt.style.use("dark_background")

# ---- Constants ----
c,G,M_E = 2.99792458e8,6.67430e-11,5.9722e24
q,m,Bz  = 1.602176634e-19,1.67262192369e-27,1.5
L0,R_major,a_minor = 1e-3,2e-2,4e-3
Npart,beta0 = 400,0.12
v0 = beta0*c
n_periods,steps_per_period = 5.0,800
T_c = 2*np.pi*m/(abs(q)*Bz)
dt,Nsteps = T_c/steps_per_period,int(n_periods*steps_per_period)
rng=np.random.default_rng(42)

# ---- Potential & STUR scalar ----
def phi(x,y,z):
    r=math.sqrt(x*x+y*y+z*z)+1e-18;return -G*M_E/r
def grad_phi(x,y,z):
    r2=x*x+y*y+z*z+1e-18;r=math.sqrt(r2);f=G*M_E/(r2*r)
    return f*x,f*y,f*z
def S_STUR(x,y,z):
    Phi=phi(x,y,z);scale=1-2*Phi/c**2;r2=scale*(x*x+y*y+z*z)
    if r2<=0:return 0.0
    rp=math.sqrt(r2);u=rp/L0
    return math.tanh(u)*(1-math.exp(-u))

# ---- Torus distribution ----
Œ∏,œà=rng.uniform(0,2*np.pi,Npart),rng.uniform(0,2*np.pi,Npart)
r_minor=a_minor*(0.6+0.4*rng.random(Npart))
x=(R_major+r_minor*np.cos(œà))*np.cos(Œ∏)
y=(R_major+r_minor*np.cos(œà))*np.sin(Œ∏)
z=r_minor*np.sin(œà)
tx,ty,tz=-np.sin(Œ∏),np.cos(Œ∏),0*Œ∏
pitch=0.15
vx=v0*(tx/np.sqrt(1+pitch**2))
vy=v0*(ty/np.sqrt(1+pitch**2))
vz=v0*(pitch/np.sqrt(1+pitch**2))

def Œ≥(vx,vy,vz):
    b2=(vx*vx+vy*vy+vz*vz)/c**2
    return 1/np.sqrt(1-np.clip(b2,0,0.9999999))
def boris(vx,vy,vz,S,dt):
    g=Œ≥(vx,vy,vz);Œ∏=(q*Bz/(g*m))*S*dt
    cth,sth=np.cos(Œ∏),np.sin(Œ∏)
    vxn=cth*vx-sth*vy;vyn=sth*vx+cth*vy;return vxn,vyn,vz

S_hist,gam_hist,uinv_hist=np.zeros(Nsteps),np.zeros(Nsteps),np.zeros(Nsteps)

for k in range(Nsteps):
    gx=gy=gz=np.zeros_like(x),np.zeros_like(y),np.zeros_like(z)
    for i in range(Npart):
        dpx,dpy,dpz=grad_phi(x[i],y[i],z[i])
        gx[i],gy[i],gz[i]=-dpx,-dpy,-dpz
    vx+=0.5*dt*gx;vy+=0.5*dt*gy;vz+=0.5*dt*gz
    S_loc=np.array([S_STUR(x[i],y[i],z[i]) for i in range(Npart)])
    vx,vy,vz=boris(vx,vy,vz,S_loc,dt)
    for i in range(Npart):
        dpx,dpy,dpz=grad_phi(x[i],y[i],z[i])
        gx[i],gy[i],gz[i]=-dpx,-dpy,-dpz
    vx+=0.5*dt*gx;vy+=0.5*dt*gy;vz+=0.5*dt*gz
    x+=vx*dt;y+=vy*dt;z+=vz*dt
    g=Œ≥(vx,vy,vz);inv=-(g*c)**2+(g*vx)**2+(g*vy)**2+(g*vz)**2
    S_hist[k]=np.mean(S_loc);gam_hist[k]=np.mean(g);uinv_hist[k]=np.mean(inv)

r=np.sqrt(x*x+y*y+z*z)
summary={
 "N_particles":int(Npart),"B_T":float(Bz),"L0_m":float(L0),
 "R_major_m":float(R_major),"a_minor_m":float(a_minor),
 "beta0":float(beta0),"dt_s":float(dt),"steps":int(Nsteps),
 "runtime_periods_ref":float(n_periods),
 "mean_S_over_time":float(np.mean(S_hist)),
 "mean_gamma_over_time":float(np.mean(gam_hist)),
 "uinv_flat_mean":float(np.mean(uinv_hist)),
 "uinv_flat_std":float(np.std(uinv_hist)),
 "radius_min_max_m":[float(r.min()),float(r.max())]
}
print("\\n=== STUR Plasma Torus (Multi, 4D/GR weak) ‚Äì SUMMARY ===")
print(json.dumps(summary,indent=4))

# ---- Plots ----
t=np.arange(Nsteps)*dt
plt.figure(figsize=(6.5,6.5))
plt.scatter(x,y,s=6,alpha=.75)
plt.Circle((0,0),R_major,fill=False,ls="--",alpha=.5)
plt.axis("equal");plt.grid(alpha=.3)
plt.xlabel("x (m)");plt.ylabel("y (m)")
plt.title("STUR Plasma Torus ‚Äî XY Projection (final)");plt.tight_layout();plt.show()

plt.figure(figsize=(7,3.8))
plt.scatter(x,z,s=6,alpha=.75);plt.axhline(0,ls="--",alpha=.4)
plt.grid(alpha=.3);plt.xlabel("x (m)");plt.ylabel("z (m)")
plt.title("XZ Projection (final)");plt.tight_layout();plt.show()

plt.figure(figsize=(7,3))
plt.plot(t,S_hist);plt.axhline(1,ls="--",alpha=.5)
plt.xlabel("t (s)");plt.ylabel("S");plt.title("Mean STUR Scalar vs Time")
plt.grid(alpha=.3);plt.tight_layout();plt.show()

plt.figure(figsize=(7,3))
plt.plot(t,gam_hist);plt.xlabel("t (s)");plt.ylabel("Œ≥")
plt.title("Mean Lorentz Factor vs Time")
plt.grid(alpha=.3);plt.tight_layout();plt.show()

plt.figure(figsize=(7,3))
plt.plot(t,uinv_hist);plt.axhline(-c*c,ls="--",alpha=.6)
plt.xlabel("t (s)");plt.ylabel("‚ü®u¬∑u‚ü© (m¬≤/s¬≤)")
plt.title("Invariant Check (flat proxy)")
plt.grid(alpha=.3);plt.tight_layout();plt.show()

print("\\nWorldlines integrated: split Boris + STUR per particle + weak-field gravity.")
print("Tag @that1sheldon  #STUR  #PlasmaPhysics  #Relativity  #OpenSource")
</code></pre>

<div class="toolbar">
  <button class="btn" id="copyBtn2">üìã Copy Script</button>
  <a class="btn" href="https://jupyterlite.github.io/demo/lab/index.html" target="_blank" rel="noopener">‚ñ∂Ô∏è Open in JupyterLite</a>
</div>

<a class="back" href="../index.html">‚Üê STUR Physics Lab</a>
<footer>STUR Unified Resistance Physics ¬© Sheldon Lon Lindberg</footer>
</main>

<script>
async function copySTUR(){
  const code=document.querySelector("pre code").innerText;
  try{
    await navigator.clipboard.writeText(code);
    for(const btn of document.querySelectorAll(".btn")){
      if(btn.textContent.includes("Copy")){
        const old=btn.textContent;
        btn.textContent="‚úÖ Copied!";
        setTimeout(()=>btn.textContent=old,1500);
      }
    }
  }catch(e){
    alert("Copy failed. Please select text manually.");
  }
}
document.getElementById("copyBtn").addEventListener("click",copySTUR);
document.getElementById("copyBtn2").addEventListener("click",copySTUR);
</script>
</body>
</html>
